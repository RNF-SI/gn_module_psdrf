<button class="m-2" mat-raised-button matTooltip="Revenir à l'écran d'accueil" (click)="returnToPreviousPage()">
    <mat-icon> arrow_back </mat-icon>
    <span class="user-name">
        {{ currentUser?.user_login }}
    </span>
</button>
<div class="container-fluid p-2">
    <mat-card>
        <mat-card-title>Ajouter un utilisateur du module PSDRF</mat-card-title>

        <div class="panel-body ">
            <form [formGroup]="form">
                <h5>Utilisateur</h5>

                <div class="form-group row">
                    <label for="prenom_role" class="col-md-3 col-form-label text-md-right">
                        Prénom
                        </label>
                    <div class="col-md-9 col-lg-7">
                        <input type="text" class="form-control" id="prenom_role" placeholder="Prénom" formControlName="prenom_role">
                        <small *ngIf="
                            form.get('prenom_role').hasError('required') &&
                            form.get('prenom_role').touched
                            ">
                            Ce champ est nécessaire
                        </small>
                    </div>
                </div>

                <div class="form-group row">
                    <label for="nom_role" class="col-md-3 col-form-label text-md-right">
                        Nom
                        </label>
                    <div class="col-md-9 col-lg-7">
                        <input type="text" class="form-control" id="nom_role" placeholder="Nom" formControlName="nom_role">
                        <small *ngIf="
                            form.get('nom_role').hasError('required') && form.get('nom_role').touched
                            ">
                            Ce champ est nécessaire
                        </small>
                    </div>
                </div>

                <div class="form-group row">
                    <label for="email" class="col-md-3 col-form-label text-md-right">
                        Adresse email
                        </label>
                    <div class="col-md-9 col-lg-7">
                        <input type="text" [ngClass]="form.disabled ? 'form-control-plaintext' : 'form-control'" id="email" placeholder="Email" formControlName="email">
                    </div>
                </div>

                <mat-divider></mat-divider>

                <h5>Compte</h5>

                <div class="form-group row">
                    <label for="identifiant" class="col-md-3 col-form-label text-md-right">
                        Identifiant
                        </label>
                    <div class="col-md-9 col-lg-7">
                        <input type="text" class="form-control" id="identifiant" placeholder="Identifiant" formControlName="identifiant" matTooltipPosition="above" matTooltip="Cet identifiant vous sera demandé pour vous authentifier dans GeoNature." />
                        <small *ngIf="
                            form.get('identifiant').hasError('required') &&
                            form.get('identifiant').touched
                            ">
                            Ce champ est nécessaire
                        </small>
                    </div>
                </div>

                <mat-divider></mat-divider>

                <h5>Informations complémentaires</h5>

                <div class="form-group row">
                    <label for="organisme" class="col-md-3 col-form-label text-md-right">
                        Organisme
                        </label>
                    <div class="col-md-9 col-lg-7">
                        <input type="text" class="form-control" id="organisme" placeholder="Organisme" formControlName="organisme">
                    </div>
                </div>

                <div class="form-group row">
                    <label for="remarques" class="col-md-3 col-form-label text-md-right">
                        Remarques
                        </label>
                    <div class="col-md-9 col-lg-7">
                        <textarea id="remarques" class="form-control" placeholder="Précisions diverses..." formControlName="remarques"></textarea>
                    </div>
                </div>

                <pnx-dynamic-form-generator [autoGenerated]="true" [myFormGroup]="dynamicFormGroup" [formsDefinition]="FORM_CONFIG">
                </pnx-dynamic-form-generator>

                <div class="text-center">
                    <button type="button" class="btn btn-success" [disabled]="!form.valid || !dynamicFormGroup.valid || disableSubmit" (click)="save()">
                        Inscrire
                        </button>
                </div>
            </form>
        </div>

    </mat-card>
</div>

<div class="container-fluid p-2">
    <mat-card>
        <mat-card-title>Ajouter des dispositifs à un utilisateur</mat-card-title>

        <div class="panel-body ">
            <form [formGroup]="dispForm">

                <div class="form-group row">
                    <label for="utilisateur" class="col-md-3 col-form-label text-md-right">
                        Utilisateur
                    </label>
                    <div class="col-md-9 col-lg-7">
                        <mat-select formControlName="utilisateur" placeholder="Utilisateur">
                            <mat-option *ngFor="let utilisateur of utilisateurList" [value]="utilisateur.id_role">{{utilisateur.nom_role}} {{utilisateur.prenom_role}}</mat-option>
                        </mat-select>
                    </div>
                </div>

                <div class="form-group row">
                    <label for="dispositif" class="col-md-3 col-form-label text-md-right">
                        Dispositif
                    </label>
                    <div class="col-md-9 col-lg-7">
                        <mat-select formControlName="dispositif" placeholder="Dispositif">
                            <mat-option *ngFor="let dispositif of dispositifList" [value]="dispositif.id">{{dispositif.name}}</mat-option>
                        </mat-select>
                    </div>
                </div>

                <pnx-dynamic-form-generator [autoGenerated]="true" [myFormGroup]="dynamicDispFormGroup" [formsDefinition]="FORM_CONFIG">
                </pnx-dynamic-form-generator>

                <div class="text-center">
                    <button type="button" class="btn btn-success" [disabled]="!dispForm.valid || !dynamicDispFormGroup.valid || disableSubmitDisp" (click)="addRoleDisp()">
                        Ajouter
                        </button>
                </div>
            </form>
        </div>

    </mat-card>

</div>